{
  "hash": "d95eefc60c30e489634100671ccfff7e",
  "result": {
    "markdown": "---\ntitle: \"Open-Ended Analysis: National Parks\"\nauthor: \"Hailey Ernest\"\ndate: \"2023-12-12\"\ncategories: [code, analysis]\n---\n\n### Investigating National Parks {style=\"color: red\"}\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code chunk to load packages and import data\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(purrr)\nnational_park <- read.csv(\"national_park_trails.csv\")\n```\n:::\n\n\nThe dataset analyzed is the collection of all of the national parks in the United States, including the state in which each park is located, the date when it was established, its total area, the number of recreation visitors it receives each year, and a description of its key features.\n\n## Start Exploring\n\n#### What is the length in miles of the fourth longest trail in California?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Q1 code + output\nnational_park|>\n  filter(state_name == \"California\")|>\n  mutate(length_mi = length*0.000621371) |>\n  slice_max(n = 4, order_by = length_mi)|>\n  slice(4)|>\n  select(name, length_mi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           name length_mi\n1 Big SEKI Loop  145.1996\n```\n:::\n:::\n\n\n\nConsider an \"easy\" trail to be one that has an elevation gain of less than 500 meters, a distance of less than 5 kilometers, and a difficulty rating below 4.\n\n#### Which California National Park has most \"easy\" trails?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnational_park|>\n  mutate(length_km = length*0.001)|>\n  filter(elevation_gain < 500, difficulty_rating < 4, length_km < 5)|>\n  group_by(area_name)|>\n  summarise(easy_trail_num = n())|>\n  slice_max(n=1, order_by = easy_trail_num)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n  area_name            easy_trail_num\n  <chr>                         <int>\n1 Acadia National Park             87\n```\n:::\n:::\n\n\n#### How many National Parks contain the word \"Mountain\" somewhere in their name?\n\n(If it is an abbreviation, like \"Mount\" or \"Mt\", that counts too.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnational_park|>\n  filter(str_detect(area_name, \"Mount|Mt|Mountain\"))|>\n  count()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    n\n1 654\n```\n:::\n:::\n\nWrite code to create the np_trails_new object to follow specific criteria.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnp_trails_new <- national_park |>\n  pivot_longer(\n    cols = c(avg_rating, difficulty_rating, popularity, visitor_usage),\n    names_to = \"measure\",\n    values_to = \"score\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnp_trails_new %>%\n  ggplot(aes(x=score)) +\n  geom_density() +\n  facet_wrap(~ measure, scales = 'free') +\n  ggtitle(\"Overall distribution of various trail scores in National parks\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 253 rows containing non-finite outside the scale range\n(`stat_density()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n#### Write a functions to help recommend trails to a user.\n\nThe function will have as its input the dataset and the name of a National Park, and the following optional arguments:\n\n-   A minimum trail elevation gain (in meters)\n-   A maximum trail elevation gain (in meters)\n-   A minimum trail rating\n-   The type of trail\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrecommend_trails <- function(data, park_name, min_elev = 0, max_elev = Inf, min_rating = 0, trl_type = NULL){\n\n  stopifnot(is.data.frame(data),\n            is.numeric(min_elev),\n            is.numeric(max_elev),\n            is.numeric(min_rating))\n  \n  recommended_trails <- data |>\n    filter(area_name == park_name,\n           elevation_gain >= min_elev,\n           elevation_gain <= max_elev,\n           avg_rating >= min_rating)\n\n  if (!missing(trl_type)) {\n    recommended_trails <- recommended_trails |>\n      filter(route_type %in% trl_type)\n  }\n  \n  recommended_trails <- recommended_trails |>\n    select(name)\n  \n  return(recommended_trails)\n}\n```\n:::\n\n\nTest the function with the code below. \n\n::: {.cell}\n\n```{.r .cell-code}\n## Q5 code - do not change except for the dataset name\nnational_park |> \n  recommend_trails(\"Haleakala National Park\", \n                   min_elev = 1000, \n                   min_rating = 4\n                   )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                  name\n1 Silversword Loop Via Halemau'u Trail\n2                  Keonehe'ehe'e Trail\n3                          Kaupo Trail\n```\n:::\n:::\n\n## Functional Programming with map\n\n#### Use your function to recommend me trails from nearby parks\n\nI am looking for a trail that is:\n\n-   1000-3000 meters of elevation (I like mountains, but not too big.)\n\n-   Rated at least a 4.5 on average\n\n-   A loop trail (I don't like to retrace my steps)\n\nIterate over the following parks to recommend me trails: Yosemite, Joshua Tree, Death Valley, Pinnacles, Lassen, Sequoia, and King's Canyon.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_dfr(.x = c(\"Yosemite National Park\",\n               \"Joshua Tree National Park\",\n               \"Death Valley National Park\",\n               \"Pinnacles National Park\",\n               \"Lassen National Park\",\n               \"Sequoia National Park\",\n               \"King's Canyon National Park\"),\n        ~ recommend_trails(data = national_park,\n                           park_name = .x,\n                           min_elev = 1000,\n                           max_elev = 3000,\n                           min_rating = 4.5,\n                           trl_type = \"loop\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                                                        name\n1                                                            El Capitan Loop\n2                                          Hetch Hetchy Loop via Lake Vernon\n3                                     Four Mile Trail to Panorama Trail Loop\n4                                                        Yosemite Grand Tour\n5                                                           Clouds Rest Loop\n6                                    The Pohono Trail from Inspiration Point\n7                                 Pohono Trail: Glacier Point to Dewey Point\n8                                                     Merced Lake Loop Trail\n9                                           Happy Isles to Cloud's Rest Loop\n10                                           The High Sierra Camp Loop Trail\n11                    Mirror Lake, Snow Creek, and Upper Yosemite Falls Loop\n12                                                       Clark Range Circuit\n13                                                         Merced Lake Trail\n14                                   The Clark Range and Red Peak Pass Trail\n15                                    Jack Main Canyon and Tilden Lake Trail\n16                                Buena Vista Crest Trail to Royal Arch Lake\n17                                            Chilnualna Falls Extended Loop\n18 Happy Isles, Vernall Falls, Half Dome, Tenaya Lake, and Mirror Lakes Loop\n19                          Buena Vista, Royal Arch, and Crescent Lakes Loop\n20   Merced Lake to Half Dome Loop via John Muir, Pack and Cloud Rest Trails\n21                    Tuolome, Sunrise and Merced Lakes, and Vogelslang Loop\n22                                            Taft Point via Four Mile Trail\n23                                  Vogelsang Basin Loop via John Muir Trail\n24                                             Tenaya Lake to Half Dome Loop\n25                                             Cottonwood-Marble Canyon Loop\n26                                   Mineral King to Little Five Lakes Trail\n27                                        Mineral King: Black Rock Pass Loop\n```\n:::\n:::\n\n\n# Research Question\n\nTwo of the most famous parks in the world are Yosemite and Yellowstone. We are interested in studying if one of the parks has \"better\" trails than the other. It is up to you to decide what the definition of \"better\" is that you will use.\n\n## Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnational_park |>\n  filter(area_name %in% c(\"Yosemite National Park\", \"Yellowstone National Park\"),\n         avg_rating > 3, \n         !str_detect(features, \"'dogs-no'\"))|>\n  ggplot(aes(x=popularity, y=length, color=area_name))+\n  geom_line()+\n  labs(x = \"Popularity\", \n       y= \"Length (meters)\", \n       title = \"Popularity of Famous Trails By Trail Length\", \n       color=\"National Park\")+\n  scale_color_manual(values = c(\"Yosemite National Park\" = \"brown\", \"Yellowstone National Park\" = \"#CD9600\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\nAfter comparing Yosemite and Yellowstone National Parks, we conclude that Yosemite National Park is better because the parks that have a high average rating while allowing dogs have a low popularity (less crowded) and variety of trail lengths compared to Yellowstone National Parks.\n\n## Statistical Analysis\n\nPreforming a statistical analysis to address the research question using Welch Two Sample t-test.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npark_data <- national_park %>%\n  filter(area_name %in% c(\"Yosemite National Park\", \"Yellowstone National Park\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Q9 statistical model code\nbetter_park <- national_park |>\n  filter(area_name %in% c(\"Yosemite National Park\", \"Yellowstone National Park\"))|>\n  select(area_name, avg_rating, popularity)\n\nt_test_rating_result <- t.test(avg_rating ~ area_name, data = better_park)\nt_test_popularity_result <- t.test(popularity ~ area_name, data = better_park)\n\nprint(t_test_rating_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  avg_rating by area_name\nt = -0.51519, df = 461.39, p-value = 0.6067\nalternative hypothesis: true difference in means between group Yellowstone National Park and group Yosemite National Park is not equal to 0\n95 percent confidence interval:\n -0.2977996  0.1740864\nsample estimates:\nmean in group Yellowstone National Park    mean in group Yosemite National Park \n                               4.002193                                4.064050 \n```\n:::\n\n```{.r .cell-code}\nprint(t_test_popularity_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  popularity by area_name\nt = -3.0583, df = 401.26, p-value = 0.002375\nalternative hypothesis: true difference in means between group Yellowstone National Park and group Yosemite National Park is not equal to 0\n95 percent confidence interval:\n -3.6614668 -0.7961367\nsample estimates:\nmean in group Yellowstone National Park    mean in group Yosemite National Park \n                               7.006884                                9.235686 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbetter_park|>\n  ggplot(aes(x=area_name, y=popularity)) +  \n  geom_boxplot() + \n  ylab(\"Popularity\") + \n  xlab(\"National Park\") + \n  labs(title=\"Side-by-side Boxplot of Popularity of Famous National Parks\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nBased on the statistical evidence found in the t-test comparing Yellow Stone National Park and Yosemite National Park, we found that when it comes to average rating there was no statistically significant difference between the parks but when it comes to popularity Yosemite had a statistically significant average of 9.235 compared to 7.001 making it the better National Park.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}